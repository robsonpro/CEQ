<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robson Bruno Dutra Pereira">

<title>Cartas de controle para variáveis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="EQI_4_files/libs/clipboard/clipboard.min.js"></script>
<script src="EQI_4_files/libs/quarto-html/quarto.js"></script>
<script src="EQI_4_files/libs/quarto-html/popper.min.js"></script>
<script src="EQI_4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EQI_4_files/libs/quarto-html/anchor.min.js"></script>
<link href="EQI_4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EQI_4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EQI_4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EQI_4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EQI_4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cartas de controle para variáveis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-contents">
             <p>Robson Bruno Dutra Pereira </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introdução" class="level2">
<h2 class="anchored" data-anchor-id="introdução">Introdução</h2>
<p>Uma característica de qualidade medida em escala contínua é chamada de <strong>variável</strong>. Por exemplo, volume, dimensão, temperatura, pressão, rugosidade, entre outras. Para controle estatístico de variáveis geralmente são usadas duas cartas, uma para a média do processo e outra para a dispersão deste. Enquanto a carta para média visa monitorar causas especiais de variação, a carta para dispersão é usada para monitorar causas comuns de variação.</p>
<p>A carta x-barra ou <span class="math inline">\(\overline x\)</span> é a carta usada para monitorar a média do processo. Já a dispersão pode ser monitorada a partir da carta de amplitude, <span class="math inline">\(R\)</span>, ou da carta de desvio-padrão, <span class="math inline">\(s\)</span>, ou ainda a da variância <span class="math inline">\(s^2\)</span>. Entretanto, dada a facilidade de cálculo, há um século atrás quando as cartas foram desenvolvidas por Shewart, era mais fácil calcular a amplitude que o desvio-padrão, populariando o uso da carta <span class="math inline">\(R\)</span> junto à carta <span class="math inline">\(\overline x\)</span>.</p>
<p>A seguir iustra-se uma carta x-barra com dois momentos distintos. Em um primeiro momento, considerando o horizonte de produção e controle relacionado às amostras 1 a 20, observa-se que o processo está estável, uma vez que as médias amostrais, plotadas em verde, estão dentro dos limites de controle. Posteriormente, das amostras 21 a 35, plotadas em vermelho, observa-se que houve um deslocamento considerável na média. Pode-se considerar que as amostras de 1 a 20 foram usadas para estimar os limites de controle, na primeira fase do monitoramento, enquanto as amostras 21 a 35 foram plotadas junto aos limites estimados anteriormente para controlar a produção futura. Possívelmente há uma causa especial ou atribuível de variação no processo. Observa-se ao lado os gráficos de densidade da distribuição normal representando a variabilidade e média dos processos antes e depois do deslocamento na média. Ao observar uma situação similar a esta pode-se usar de ferramentas de qualidade e de gerenciamento da mehoria de qualidade como DMAIC ou PDCA para identificar o problema, se possível antes de voltar à produção.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Os esquemas de controle tanto usando cartas <span class="math inline">\(\overline x\)</span>/<span class="math inline">\(R\)</span> ou <span class="math inline">\(\overline x\)</span>/<span class="math inline">\(s\)</span> é baseado em amostras, sendo os mais aplicados em sistemas de produção em lotes ou em massa de produtos discretos, uma vez que o custo de monitoramento de 100% da produção é alto. Tal esquema de controle por amostragem é baseado em subgrupos racionais. Cada subgrupo ou amostra é tomado em um instante de tempo no horizonte de produção. O conceito de subgrupo racional implica na seleção de amostras de modo que, se causas atribuíveis estiverem presentes, a chance de diferenças entre subgrupos será maximizada, enquanto a chance de diferenças devido a causas atribuíveis dentro de um subgrupo será minimizada. Ou seja, deve-se planejar o intervalo de tempo ideal para coleta de novas amostras, visando a garantia de que possíveis mudanças devido a causas atribuíveis não demorem a ser detectadas.</p>
<p>É importante também diferenciar limites de controle e limites de especificação, possibilitando o entendimento do que é variabilidade de processo e do que é capacidade de processo. Especificação consiste em limites relacionados ao projeto do produto, norma ou pedido do cliente. Ou seja, são limites que foram especificados para a variável sob controle e devem ser atendidos, de forma que o produto seja dito conforme. Já os limites de controle são calculados considerando a variabilidade do processo e servem para medir o seu desempenho. A Figura abaixo ilustra um caso onde uma característica de qualidade monitorada apresenta limites de especificação iguais a 94 e 106. Dois processos são monitorados, um processo “A” apresenta média centrada na especificação, isto é, igual a 100, com limites de controle iguais a 97 e 103. Já o processo “B” apresenta média deslocada à direita e igual a 105, com limites de controle iguais a 102 e 108. Observa-se que a variabilidade de ambos os processos são iguais, porém o processo B apresenta média mais alta. Pode-se observar que o processo B apresenta maior probabilidade de apresentar resultados acima do limite superior de especificação, mesmo estando sob controle.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A seguir compara-se novamente o processo “A” a um processo “C” que, apesar de apresentar a mesma média que “A”, apresenta uma variabilidade maior. Observa-se que enquanto ambos os limites de controle de A estão dentro dos limites de especificação, no processo C os limites de controle estão para além dos =de especificação. Logo, mesmo o processo estando sob controle, este pode não ser capaz de atender às especificações do processo. Os limites de controle medem a variabilidade do processo, ou seja, dentro destes há uma confiança de encontrar a média da característica de qualidade monitorada. Enquanto os limites de controle são estimados a partir de amostras da característica de qualidade monitorada, os limites de especificação já são estabelecidos antes de começar a produção e devem ser atendidos ou respeitados. O não atendimento destes acarretará no prejuizo, ou seja, produção de itens fora do especificado, sendo estes descartados ou sendo necessário correções e retrabalho.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cartas-de-controle-x-barra-e-r" class="level2">
<h2 class="anchored" data-anchor-id="cartas-de-controle-x-barra-e-r">Cartas de controle x-barra e R</h2>
<p>Seja uma variável <span class="math inline">\(x\)</span> normalmente distribuída com média <span class="math inline">\(\mu\)</span> e desvio-padrão <span class="math inline">\(\sigma\)</span>. Se <span class="math inline">\(x_1, x_2, ..., x_n\)</span> é uma amostra de tamanho <span class="math inline">\(n\)</span>, então a média desta amostra é:</p>
<p><span class="math display">\[
\overline x = \frac{x_1+x_2+...+x_n}{n}= \frac{\sum_{i=1}^nx_i}{n}.
\]</span></p>
<p>Sabe-se que <span class="math inline">\(\overline x\)</span> é normalmente distribuída com média <span class="math inline">\(\mu\)</span> e desvio-padrão <span class="math inline">\(\sigma_{\overline x} = \sigma/\sqrt{n}\)</span>.</p>
<p>Existe a probabilidade ou confiança igual a <span class="math inline">\(\gamma = 1-\alpha\)</span> de que qualquer amostra desta variável caia entre</p>
<p><span class="math display">\[
\mu \pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}.
\]</span></p>
<p>Logo, se <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span> são conhecidos, pode-se usar os limites acima para controlar a média. Geralmente usa-se <span class="math inline">\(z_{\alpha/2}=3\)</span>, de forma que <span class="math inline">\(\gamma = 0,9973\)</span>.</p>
<p>Na prática não se conhece <span class="math inline">\(\mu\)</span> e <span class="math inline">\(\sigma\)</span>, sugerindo-se usar <span class="math inline">\(m\)</span> de 20 a 25 amostras de tamanho <span class="math inline">\(n\)</span> para estimativa dos parâmetros e cálculo dos limites de controle. A Tabela a seguir sugere como as amostras podem ser organizadas para monitorar o processo.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Amostra</th>
<th><span class="math inline">\(x_1\)</span></th>
<th><span class="math inline">\(x_2\)</span></th>
<th><span class="math inline">\(\dots\)</span></th>
<th><span class="math inline">\(x_n\)</span></th>
<th><span class="math inline">\(\overline{x}\)</span></th>
<th><span class="math inline">\(R\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><span class="math inline">\(x_{11}\)</span></td>
<td><span class="math inline">\(x_{12}\)</span></td>
<td><span class="math inline">\(\dots\)</span></td>
<td><span class="math inline">\(x_{1n}\)</span></td>
<td><span class="math inline">\(\overline{x}_1\)</span></td>
<td><span class="math inline">\(x_{1\text{(max)}} -x_{1\text{(min)}}\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(x_{21}\)</span></td>
<td><span class="math inline">\(x_{22}\)</span></td>
<td><span class="math inline">\(\dots\)</span></td>
<td><span class="math inline">\(x_{2n}\)</span></td>
<td><span class="math inline">\(\overline{x}_2\)</span></td>
<td><span class="math inline">\(x_{2\text{(max)}} -x_{2\text{(min)}}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\ddots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(m\)</span></td>
<td><span class="math inline">\(x_{m1}\)</span></td>
<td><span class="math inline">\(x_{m2}\)</span></td>
<td><span class="math inline">\(\dots\)</span></td>
<td><span class="math inline">\(x_{mn}\)</span></td>
<td><span class="math inline">\(\overline{x}_m\)</span></td>
<td><span class="math inline">\(x_{m\text{(max)}} -x_{m\text{(min)}}\)</span></td>
</tr>
</tbody>
</table>
<p>Para cada amostra pode-se calcular a média <span class="math inline">\(\overline x_j\)</span> e a amplitude <span class="math inline">\(R = x_{j\text{(max)}} -x_{j\text{(min)}}\)</span>, <span class="math inline">\(j=1,...,m\)</span>, conforme as últimas duas colunas da tabela, para monitorar causas especiais e comuns, respectivamente.</p>
<p>A estimativa para a média geral será:</p>
<p><span class="math display">\[
\overline{\overline{x}} = \frac{\overline x_1+\overline x_2+...+\overline x_m}{m}= \frac{\sum_{j=1}^m \overline x_j}{m}.
\]</span></p>
<p>Já a média das amplitudes ou a amplitude média será:</p>
<p><span class="math display">\[
\overline R = \frac{R_1 + R_2 + ... R_m}{m} =  \frac{\sum_{j=1}^m R_j}{m}.
\]</span></p>
<p>Os limites de controle para a carta <span class="math inline">\(\overline x\)</span> podem ser estimados conforme segue:</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp;\text{ } \overline{\overline{x}} + A_2\overline R\\
LC =&amp;\text{ } \overline{\overline{x}} \\
LIC =&amp;\text{ } \overline{\overline{x}} - A_2\overline R,\\
\end{align}
\]</span></p>
<p>onde <span class="math inline">\(A_2\)</span> é uma constante tabelada que varia segundo o tamanho amostral, <span class="math inline">\(n\)</span>. Já os limites da carta para a amplitude podem ser estimados conforme segue:</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp;\text{ } D_4\overline R\\
LC =&amp;\text{ } \overline{R} \\
LIC =&amp;\text{ } D_3\overline R,\\
\end{align}
\]</span></p>
<p>onde <span class="math inline">\(D_3\)</span> e <span class="math inline">\(D_4\)</span> são constantes tabeladas para tamanhos amostrais distintos.</p>
<p>Assim como nos primordios do CEQ era mais fácil calcular a amplitude que o desvio-padrão, as constantes foram criadas para facilitar a estimativa dos limites. Observando os limites da carta x-barra, pode-se constatar que a margem de erro que define os limites, <span class="math inline">\(\pm A_2 \overline R\)</span>, consiste em uma estimativa de <span class="math inline">\(3\sigma/\sqrt{n}\)</span>. Estudou-se a média ou esperança da amplitude, <span class="math inline">\(E(R)\)</span>, vendo que esta se aproxima do desvio-padrão multiplicado por uma constante, <span class="math inline">\(d_2\)</span>, também tabelada segundo o tamanho amostral, isto é, <span class="math inline">\(E(R)=d_2\sigma\)</span>. A variável aleatória <span class="math inline">\(W=R/\sigma\)</span> foi muito estudada no início do CEQ e sua distribuição depende de <span class="math inline">\(n\)</span>, com média <span class="math inline">\(E(W) = d_2\)</span>. Logo, <span class="math inline">\(\hat\sigma = R/d_2\)</span> é um estimador não enviesado para <span class="math inline">\(\sigma\)</span>. A eficiência de tal estimativa varia segundo o tamanho amostral.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>n</th>
<th>Eficiência de <span class="math inline">\(d_2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>1,000</td>
</tr>
<tr class="even">
<td>3</td>
<td>0,992</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0,975</td>
</tr>
<tr class="even">
<td>5</td>
<td>0,955</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0,930</td>
</tr>
<tr class="even">
<td>10</td>
<td>0,850</td>
</tr>
</tbody>
</table>
<p>Recomenda-se, portanto, <span class="math inline">\(n\leq6\)</span> para cartas x-barra e R.</p>
<p>Se <span class="math inline">\(\overline{\overline{x}}\)</span> é um estimador não enviesado de <span class="math inline">\(\mu\)</span> e <span class="math inline">\(R/d_2\)</span> um estimador não enviesado de <span class="math inline">\(\sigma\)</span>, então a carta <span class="math inline">\(\overline x\)</span> fica:</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp;\text{ } \overline{\overline{x}} + \frac{3}{d_2\sqrt{n}}\overline R\\
LC =&amp;\text{ } \overline{\overline{x}} \\
LIC =&amp;\text{ } \overline{\overline{x}} - \frac{3}{d_2\sqrt{n}}\overline R,\\
\end{align}
\]</span></p>
<p>porém, para facilitar o trabalho, a constante <span class="math inline">\(A_2 = 3/(d_2\sqrt{n})\)</span> foi definida e tabelada segundo o tamanho amostral, de forma que os limites de controle fiquem conforme especificado inicialmente.</p>
<p>Para a carta R há uma constante adicional que está relacionada ao desvio-padrão da amplitude, <span class="math inline">\(\sigma_R\)</span>. <span class="math inline">\(\sigma_R = d_3\sigma = d_3 \overline R/d_2\)</span>. Logo, para a carta R, tem-se:</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp; \overline{R} + 3\sigma_R = \overline{R} + 3d_3\frac{\overline{R}}{d_2}\\
LC =&amp;\overline{R} \\
LIC =&amp; \overline{R}- 3\sigma_R = \overline{R} - 3d_3\frac{\overline{R}}{d_2},\\
\end{align}
\]</span></p>
<p>Para facilitar os cálculos, foram definidos as constantes <span class="math inline">\(D_3 = 1 - 3\frac{d_3}{d_2}\)</span> e <span class="math inline">\(D_4 = 1 + 3\frac{d_3}{d_2}\)</span>, de forma que os limites expostos acima ficam conforme os expostos inicialmente.</p>
<section id="implementação" class="level3">
<h3 class="anchored" data-anchor-id="implementação">Implementação</h3>
<p>Exemplo: Uma empresa utiliza o controle estatístico de qualidade para controlar sua linha de produção de conservas de tomate. Diversas vezes, durante o turno nessa fábrica de conservas, um inspetor retirava da linha de produção 5 latas que haviam sido enchidas e seladas. O inspetor abria cada lata, esvaziava e pesava o conteúdo sólido, registrando os resultados. A tabela abaixo mostra os resultados da medição do peso drenado, abrangendo 11 dias de operação.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tomate <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"tomate.csv"</span>, <span class="at">header=</span>T)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tomate</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Subgrupo     Data    Tempo  X1  X2  X3  X4  X5
1         1 Sept. 21 09:30:00 624 638 638 680 666
2         2 Sept. 21 10:50:00 581 638 638 652 610
3         3 Sept. 21 11:45:00 567 581 652 624 610
4         4 Sept. 21 14:30:00 595 624 624 652 624
5         5 Sept. 21 17:25:00 638 553 638 624 595
6         6 Sept. 22 10:00:00 652 666 595 624 567
7         7 Sept. 22 13:15:00 539 567 624 581 638
8         8 Sept. 22 17:00:00 610 581 539 553 553
9         9 Sept. 23 09:30:00 595 638 567 624 624
10       10 Sept. 23 13:15:00 610 652 624 652 524
11       11 Sept. 23 13:45:00 567 553 595 567 581
12       12 Sept. 23 15:30:00 539 595 595 595 581
13       13 Sept. 25 08:00:00 553 581 595 581 595
14       14 Sept. 25 10:25:00 567 610 680 652 567
15       15 Sept. 25 11:30:00 638 553 595 610 595
16       16 Sept. 25 14:30:00 610 581 624 610 666
17       17 Sept. 25 15:15:00 539 610 652 595 666
18       18 Sept. 25 17:30:00 595 581 553 624 595
19       19 Sept. 26 14:00:00 567 666 680 581 610
20       20 Sept. 26 15:00:00 624 581 595 638 567
21       21 Sept. 26 16:45:00 539 581 595 581 638
22       22 Sept. 27 07:30:00 610 709 595 539 595
23       23 Sept. 27 08:35:00 638 624 652 624 666
24       24 Sept. 27 10:40:00 638 624 624 553 581
25       25 Sept. 27 13:45:00 524 624 638 595 610
26       26 Sept. 27 15:30:00 610 581 581 468 610
27       27 Sept. 27 16:00:00 680 624 496 595 638
28       28 Sept. 28 07:15:00 624 496 595 624 666
29       29 Sept. 28 07:45:00 624 567 581 680 610
30       30 Sept. 28 10:00:00 638 595 553 610 638
31       31 Sept. 28 13:15:00 567 624 567 610 567
32       32 Sept. 28 15:30:00 595 553 624 567 567
33       33 Sept. 29 09:00:00 638 610 595 610 666
34       34 Sept. 29 10:50:00 624 595 595 581 595
35       35 Sept. 29 13:15:00 709 567 567 581 638
36       36 Sept. 29 14:30:00 581 595 595 539 595
37       37 Sept. 29 16:10:00 610 624 624 567 595
38       38 Sept. 29 17:20:00 610 624 610 581 638
39       39 Sept. 30 09:30:00 638 695 723 567 595
40       40 Sept. 30 11:15:00 610 680 610 610 638
41       41 Sept. 30 14:10:00 652 666 595 610 610
42       42 Sept. 30 15:30:00 638 553 610 581 567
43       43   Oct. 2 08:20:00 666 652 695 610 581
44       44   Oct. 2 14:30:00 595 595 695 652 638
45       45   Oct. 2 15:30:00 695 610 610 638 638
46       46   Oct. 2 17:00:00 680 595 680 624 581
47       47   Oct. 3 09:15:00 666 638 567 567 595
48       48   Oct. 3 10:00:00 624 581 595 638 652
49       49   Oct. 3 13:00:00 624 666 680 624 624
50       50   Oct. 3 15:00:00 666 595 666 610 652</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qcc)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qcc.options</span>(<span class="at">bg.margin =</span> <span class="st">"white"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Serão implementadas as cartas R e x-barra para estimar os limites de controle.</p>
<p>Carta R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dados_tomate <span class="ot">&lt;-</span> tomate[,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>] </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cartaR_tomate <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type=</span><span class="st">"R"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">title =</span> <span class="st">"Carta R para a massa de conservas de tomate"</span>, <span class="at">ylab =</span> <span class="st">"R"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cartaR_tomate)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
qcc(data = dados_tomate[1:25, ], type = "R", title = "Carta R para a massa de conservas de tomate",     ylab = "R")

R chart for dados_tomate[1:25, ] 

Summary of group statistics:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  42.00   71.00   85.00   85.48   99.00  170.00 

Group sample size:  5
Number of groups:  25
Center of group statistics:  85.48
Standard deviation:  36.74979 

Control limits:
 LCL      UCL
   0 180.7449</code></pre>
</div>
</div>
<p>Carta x-barra com desvio-padrão da média estimado via amplitude média.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cartaxbar_tomate <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type=</span><span class="st">"xbar"</span>, <span class="at">std.dev =</span> <span class="st">"UWAVE-R"</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">title =</span> <span class="st">"Carta x-barra para a massa de conservas de tomate"</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ylab =</span> <span class="st">"x-barra"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cartaxbar_tomate)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
qcc(data = dados_tomate[1:25, ], type = "xbar", std.dev = "UWAVE-R",     title = "Carta x-barra para a massa de conservas de tomate",     ylab = "x-barra")

xbar chart for dados_tomate[1:25, ] 

Summary of group statistics:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
567.200 589.800 609.600 605.696 618.200 649.200 

Group sample size:  5
Number of groups:  25
Center of group statistics:  605.696
Standard deviation:  36.74979 

Control limits:
     LCL     UCL
 556.391 655.001</code></pre>
</div>
</div>
<p>Carta x-barra sem as estatísticas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cartaxbar_tomate <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], <span class="at">add.stats=</span><span class="cn">FALSE</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type=</span><span class="st">"xbar"</span>, <span class="at">std.dev =</span> <span class="st">"UWAVE-R"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">title =</span> <span class="st">"Carta x-barra para a massa de conservas de tomate"</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ylab =</span> <span class="st">"x-barra"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Realizando a implementação passo a passo (Atenção, aqui seria mais para entendimento e não para realização de prova, listas de exercícios e atuação profissional. Sugere-se usar extensivamente os pacotes, conforme feito inicialmente).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cartas-de-controle-x-barra-e-s" class="level2">
<h2 class="anchored" data-anchor-id="cartas-de-controle-x-barra-e-s">Cartas de controle x-barra e s</h2>
<p>Apesar da simplicidade da carta <span class="math inline">\(R\)</span>, em alguns casos pode ser interessante o uso da carta do desvio-padrão, <span class="math inline">\(s\)</span>, para monitorar causas comuns de variação. Em geral quando (i) o tamanho amostral, <span class="math inline">\(n\)</span>, é grande e (ii) quando <span class="math inline">\(n\)</span> varia por amostra.</p>
<p>Seja a variância amostral,</p>
<p><span class="math display">\[
s^2 =\sum_{i=1}^n\frac{(x_i-\overline x)^2}{n-1},
\]</span></p>
<p>um estimador não-enviesado para a variância populacional, isto é, <span class="math inline">\(E(s^2)=E(\sigma^2)\)</span>. Porém, o desvio-padrão amostral, <span class="math inline">\(s\)</span>, não é um estimador não enviesado para o desvio-padrão populacional, <span class="math inline">\(\sigma\)</span>. Pode-se mostrar que</p>
<p><span class="math display">\[
E(s)=\biggl(\frac{2}{n-1}\biggr) \frac{\Gamma(n/2)}{\Gamma[ (n-1)/2 ]}\sigma = c_4\sigma,
\]</span></p>
<p>onde <span class="math inline">\(c_4\)</span> é uma constante que varia segundo o tamanhoa amostral. Logo, uma estimativa não enviesada para <span class="math inline">\(\sigma\)</span> fica conforme segue.</p>
<p><span class="math display">\[
\hat \sigma = \frac{s}{c_4}
\]</span></p>
<p>Ademais, também é possível provar que o desvio-padrão de <span class="math inline">\(s\)</span> é igual a <span class="math inline">\(\sigma \sqrt{1-c_4^2}\)</span>.</p>
<p>Logo, os limites de controle para a carta <span class="math inline">\(s\)</span> ficam:</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp; s + 3\sigma_s = c_4\sigma + \sigma \sqrt{1-c_4^2}\\
LC =&amp; s = c_4\sigma\\
LIC =&amp; s - 3\sigma_s = c_4\sigma - \sigma \sqrt{1-c_4^2}\\
\end{align}
\]</span></p>
<p>Tomando os limites e colocando <span class="math inline">\(\sigma\)</span> em evidência é possível definir novas constantes, <span class="math inline">\(B_6=c_4 + \sqrt{1-c_4^2}\)</span> e <span class="math inline">\(B_5=c_4 - \sqrt{1-c_4^2}\)</span>. Logo, os limites podem ser simplificados para:</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp; B_6\sigma\\
LC =&amp; c_4\sigma\\
LIC =&amp; B_5\sigma\\
\end{align}
\]</span></p>
<p>Em muitas situações práticas não há um valor de referência para <span class="math inline">\(\sigma\)</span>. Logo, deve-se estimar <span class="math inline">\(\sigma\)</span> a partir de dados amostrais. Sejam <span class="math inline">\(m\)</span> amostras de tamanho <span class="math inline">\(n\)</span> e seja o desvio-padrão da i-ésima amostra, <span class="math inline">\(s_i\)</span>. A média dos <span class="math inline">\(m\)</span> desvios padrão é</p>
<p><span class="math display">\[\overline s=  \frac{\sum_{i=1}^ms_i}{m}.\]</span></p>
<p>A estatística <span class="math inline">\(\overline s/c_4\)</span> é um estimador não enviesado de <span class="math inline">\(\sigma\)</span>. Logo:</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp; \overline s + 3 \frac{\overline s}{c_4}\sqrt{1-c_4^2}\\
LC =&amp; \overline s\\
LIC =&amp; \overline s - 3 \frac{\overline s}{c_4}\sqrt{1-c_4^2}\\
\end{align}
\]</span></p>
<p>De forma análoga, colocando <span class="math inline">\(\overline s\)</span> em evidência, pode-se definir novas constantes <span class="math inline">\(B_3=1 - \frac{3}{c_4}\sqrt{1-c_4^2}\)</span> e <span class="math inline">\(B_4=1 + \frac{3}{c_4}\sqrt{1-c_4^2}\)</span>, simplificando a carta, conforme segue.</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp; B_4{\overline s}\\
LC =&amp; \overline s\\
LIC =&amp; B_3{\overline s}\\
\end{align}
\]</span></p>
<p>É importante recordar que quando usamos a carta <span class="math inline">\(R\)</span> para monitorar causa comum, o desvio-padrão da média, necessário à carta <span class="math inline">\(\overline x\)</span>, era estimado a partir da média das amplitudes. Logo, quando usa-se a carta <span class="math inline">\(s\)</span>, pode-se estimar <span class="math inline">\(\sigma_{\overline x}\)</span> como <span class="math inline">\(\sigma_{\overline x} = \overline s /(c_4\sqrt n)\)</span>. Logo, a carta <span class="math inline">\(\overline x\)</span> fica conforme segue.</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp;\text{ } \overline{\overline{x}} + \frac{3}{c_4\sqrt{n}}\overline s\\
LC =&amp;\text{ } \overline{\overline{x}} \\
LIC =&amp;\text{ } \overline{\overline{x}} - \frac{3}{c_4\sqrt{n}}\overline s,\\
\end{align}
\]</span></p>
<p>Fazendo <span class="math inline">\(A_3=3/(c_4\sqrt n)\)</span>, tem-se os limites da carta <span class="math inline">\(\overline x\)</span> estimados via <span class="math inline">\(\overline s\)</span>.</p>
<p><span class="math display">\[
\begin{align}
LSC =&amp;\text{ } \overline{\overline{x}} + A_3\overline s\\
LC =&amp;\text{ } \overline{\overline{x}} \\
LIC =&amp;\text{ } \overline{\overline{x}} - A_3\overline s,\\
\end{align}
\]</span></p>
<p>No início do CEQ usar a carta <span class="math inline">\(R\)</span> era mais cômodo, dada a facilidade do cálculo da amplitue amostral. Porém, hoje, com a disponibilidade de calculadoras científicas e computadores o cálculo de <span class="math inline">\(s\)</span> é realizado facilmente. Ademais, o advento dos pacotes computacionais estatísticos, por exemplo a linguagem <code>R</code> e o pacote <code>qcc</code> facilitam muito a obtenção dos limites, bastando entrar com os dados no formato apropriado e escolher a carta adequada.</p>
<section id="implementação-1" class="level3">
<h3 class="anchored" data-anchor-id="implementação-1">Implementação</h3>
<p>Carta s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cartaS_tomate <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type=</span><span class="st">"S"</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">title =</span> <span class="st">"Carta S para a massa de conservas de tomate"</span>, <span class="at">ylab =</span> <span class="st">"S"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Carta x-barra com desvio-padrão da média estimado via média dos desvios-padrão.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cartaxbar_tomate <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type=</span><span class="st">"xbar"</span>, <span class="at">std.dev =</span> <span class="st">"UWAVE-SD"</span>, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">title =</span> <span class="st">"Carta x-barra para a massa de conservas de tomate"</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ylab =</span> <span class="st">"x-barra"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="fases-i-e-ii-do-ceq" class="level2">
<h2 class="anchored" data-anchor-id="fases-i-e-ii-do-ceq">Fases I e II do CEQ</h2>
<p>O controle estatístico é geralmente realizado em duas fases. A primeira fase é a de estimativa dos limites de controle. Nesta fase são coletadas de <span class="math inline">\(m=20\)</span> a <span class="math inline">\(25\)</span> amostras de tamanho <span class="math inline">\(n\)</span> para estimar os limites de controle. Caso algum ponto apareça fora de controle, sugere-se realizar um plano de ação, por exempo empregando ferramentas de qualidade e encontrar a causa de variação atribuível à amostra em questão para eliminá-la e continuar o processo de estimativa dos limites de controle.</p>
<p>A segunda fase consiste no monitoramento da produção futura com os limites estimados na primeira fase. Nesta fase a coleta de amostras continua com a mesma periodicidade e novas observações são plotadas na carta. A diferença é que as observações futuras não são usadas para definir os limites de controle. Estes foram definidos anteriormente na primeira fase e deseja-se que o processo de controle permaneça estável, objetivo este da segunda fase.</p>
<p>É importante atualizar os limites de controle com certa frequência, de acordo com mudanças realizadas no processo ou até mesmo a necessidade de passar para um nível de variabilidade mais baixo (estreitar os limites), após alguma melhoria no processo.</p>
<section id="implementação-2" class="level3">
<h3 class="anchored" data-anchor-id="implementação-2">Implementação</h3>
<p>Carta R com dados futuros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cartaR_tomate <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">newdata =</span> dados_tomate[<span class="dv">26</span><span class="sc">:</span><span class="dv">50</span>,],</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type=</span><span class="st">"R"</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">title =</span> <span class="st">"Carta R para a massa de conservas de tomate"</span>, <span class="at">ylab =</span> <span class="st">"R"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Carta x-barra com dados futuros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>xbarfuture <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], <span class="at">newdata =</span> dados_tomate[<span class="dv">26</span><span class="sc">:</span><span class="dv">50</span>,],</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">"xbar"</span>, <span class="at">std.dev =</span> <span class="st">"UWAVE-R"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Carta x-barra para a massa de conservas de tomate"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"x-barra"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Carta x-barra com dados futuros sem dados da primeira fase.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>xbarfuture2 <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], <span class="at">newdata =</span> dados_tomate[<span class="dv">26</span><span class="sc">:</span><span class="dv">50</span>,],</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">"xbar"</span>, <span class="at">std.dev =</span> <span class="st">"UWAVE-SD"</span>, <span class="at">chart.all=</span><span class="cn">FALSE</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Carta x-barra para a massa de conservas de tomate"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"x-barra"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="critérios-para-determinar-se-um-processo-está-sob-controle-estatístico-ou-não" class="level2">
<h2 class="anchored" data-anchor-id="critérios-para-determinar-se-um-processo-está-sob-controle-estatístico-ou-não">Critérios para determinar se um processo está sob controle estatístico ou não</h2>
<p>O critério principal para dizer que um processo não está sob controle estatístico é a partir da observação de um ou mais pontos fora dos limites de controle.</p>
<p>A seguir são listadas outras regras que podem ser usadas na prática para as cartas de Shewart. As quatro primeiras foram definidas pela <em>Western Electric</em>.</p>
<ol type="1">
<li>Um ou mais pontos fora dos limites de controle;</li>
<li>Dois de três pontos consecutivos fora dos limites de alerta de dois sigma, mas ainda dentro dos limites de controle;</li>
<li>Quatro de cinco pontos consecutivos além dos limites de um sigma;</li>
<li>Uma sequência de oito pontos consecutivos em um lado da linha central</li>
<li>Seis pontos consecutivos aumentando ou diminuindo constantemente;</li>
<li>Quinze pontos consecutivos na zona C (acima e abaixo da linha central);</li>
<li>Quatorze pontos consecutivos alternando para cima e para baixo;</li>
<li>Oito pontos consecutivos em ambos os lados da linha central sem nenhum na zona C;</li>
<li>Um padrão incomum ou não aleatório nos dados;</li>
<li>Um ou mais pontos próximos a um limite de alerta ou controle.</li>
</ol>
<p>A seguir exemplica-se como identificar tais padrões indesejados nas cartas.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>É importante alertar que o excesso de regras pode gerar alarmes falsos. Conforme observados algumas regras são redundantes e em algumas situações alguns padrões podem aparecer sem clara indicação de um processo fora de controle. Ademais o excesso de regras pode dificultar o monitoramento. O ideal é que se considere pontos fora de controle, ou seja, a primeira regra como a principal. Porém, mesmo a primeira regra pode estar relacionada a um alarme falso, ou erro do tipo I.</p>
<section id="implementação-3" class="level3">
<h3 class="anchored" data-anchor-id="implementação-3">Implementação</h3>
<p>Carta x-barra com limites de aviso de 2 sigma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cartaxbar <span class="ot">&lt;-</span> <span class="fu">qcc</span>(dados_tomate[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,], </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type=</span><span class="st">"xbar"</span>, <span class="at">std.dev =</span> <span class="st">"UWAVE-R"</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="st">"Carta x-barra para a massa de conservas de tomate"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"x-barra"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>limites.aviso <span class="ot">&lt;-</span> <span class="fu">limits.xbar</span>(cartaxbar<span class="sc">$</span>center, cartaxbar<span class="sc">$</span>std.dev, cartaxbar<span class="sc">$</span>sizes, <span class="dv">2</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cartaxbar, <span class="at">restore.par =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> limites.aviso, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"orangered"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="prova-que-es-c_4sigma" class="level3">
<h3 class="anchored" data-anchor-id="prova-que-es-c_4sigma">Prova que <span class="math inline">\(E(s) = c_4\sigma\)</span></h3>
<p>Vamos demonstrar que o valor esperado do desvio padrão amostral é dado por:</p>
<p><span class="math display">\[E(s) = \sqrt{\frac{2}{n-1}} \frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)} \sigma = c_4 \sigma\]</span></p>
</section>
</section>
<section id="comprimetno-médio-da-sequência" class="level2">
<h2 class="anchored" data-anchor-id="comprimetno-médio-da-sequência">Comprimetno médio da sequência</h2>
<p>O comprimento médio da sequência (<em>average run length</em> - ARL) consiste no número médio de pontos ou amostras até uma observação ser plotada fora dos limites. Existem dois tipos de comprimento médio da sequência: um quando o processo está sob controle e um ponto é plotado fora, sendo este classificado como alarme falso; e outro quando o processo está de fato fora de controle e deseja-se saber o número médio de pontos necessários para que a carta identifique o desvio, ou seja, deseja-se medir a sensibilidade da carta à presença de causas especiais.</p>
<section id="arl_0" class="level3">
<h3 class="anchored" data-anchor-id="arl_0"><span class="math inline">\(ARL_0\)</span></h3>
<p>Seja o comprimento médio da sequência para um processo sob controle estatístico:</p>
<p><span class="math display">\[
ARL_0 = \frac{1}{\alpha}
\]</span></p>
<p>onde <span class="math inline">\(alpha = 1 - \gamma\)</span>. Sabe-se que quando são considerados limites de 3 desvios-padrões, <span class="math inline">\(\gamma = 0,9973\)</span>. Logo, <span class="math inline">\(\alpha = 0,0027\)</span> na maioria dos casos. A seguir observa-se uma carta com 500 observações e apenas um ponto fora de controle. Neste caso o ponto fora de controle é da amostra 373, bem próximo do esperado. Trata-se de um alarme falso, o próprio padrão da carta não aponta indícios significativos de causa especial.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="arl_1" class="level3">
<h3 class="anchored" data-anchor-id="arl_1"><span class="math inline">\(ARL_1\)</span></h3>
<p>Quando o processo está fora de controle não necessariamente a carta identificará um ponto fora de controle rapidamente. Podem ser necessários produzir fora de controle durante o tempo, até que a carta aponte um ponto fora dos limites.</p>
<p>Seja <span class="math inline">\(\beta\)</span> a probabilidade ou risco de a carta não detectar uma causa especial de variação. Suponha que a média, <span class="math inline">\(\mu\)</span>, quando está sob controle é <span class="math inline">\(\mu_0\)</span> e quando o processo está fora de controle é <span class="math inline">\(\mu_1 = \mu_0+k\sigma\)</span>, ou seja a média a média sob controle adicionada de um desvio de <span class="math inline">\(k\)</span> desvios-padrões. A probabilidade de não detectar o desvio a partir da primeira amostra plotada após a causa especial é:</p>
<p><span class="math display">\[
\beta = p(LIC \leq \overline x \leq LSC | \mu = \mu_0+k\sigma).
\]</span></p>
<p>Sabendo-se que os limites de controle da carta <span class="math inline">\(\overline{x}\)</span> são estimados como <span class="math inline">\(LIC/LSC = \overline{\overline{x}} \pm L\sigma/\sqrt{n}\)</span>, considere o caso onde a carta é padronizada, de forma que</p>
<p><span class="math display">\[
\overline z = \frac{\overline x - \mu}{\sigma/\sqrt{n}}.
\]</span></p>
<p>Neste caso os limites poderiam ser expressos como <span class="math inline">\(LIC/LSC =\pm L\)</span>, ou na maioria das cartas, <span class="math inline">\(LIC/LSC =\pm 3\)</span>. Logo:</p>
<p><span class="math display">\[
\beta = p(-L \leq \overline x \leq L | \mu = \mu_0+k\sigma).
\]</span></p>
<p>Tomando a média a ser plotada após a causa especial, tem-se que <span class="math inline">\(\overline x \to \mu_0 + k\sigma\)</span>. Padronizando a média antes de plotar na carta padronizada:</p>
<p><span class="math display">\[
\frac{\overline x - \mu_0}{\sigma/\sqrt{n}} = \frac{(\mu_0 + k\sigma) - \mu_0}{\sigma/\sqrt{n}} \simeq k\sqrt n.
\]</span></p>
<p>Logo,</p>
<p><span class="math display">\[
\beta = p(\overline z \leq L-k\sqrt{n}) - p(\overline z \leq -L-k\sqrt{n}) = \Phi(L-k\sqrt{n})-\Phi(-L-k\sqrt{n})
\]</span></p>
<p>Como <span class="math inline">\(\beta\)</span> é a probabilidade de a carta não detectar um desvio, <span class="math inline">\(1-\beta\)</span> seria a probabilidade de a carta plotar um ponto fora de cobtrole dado que há uma causa especial de variação presente no processo. Logo,</p>
<p><span class="math display">\[
ARL_1 =  \frac{1}{1-\beta}.
\]</span></p>
<p>A seguir plotam-se curvas característica de operação para distintos tamanhos amostrais. Observa-se que o erro <span class="math inline">\(\beta\)</span> diminui à medida que aumenta um tamanho amostral para um <span class="math inline">\(k\)</span> fixo. Ou para um tamanho amostraç <span class="math inline">\(n\)</span> fixo, observa-se que quanto maior o deslocamento na média <span class="math inline">\(k\)</span>, menor o risco de a carta não detectar a causa especial.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Abaixo observa-se um caso onde após o estabelecimento dos limites, no início do controle da produção futura, aconteceu um desvio no processo de <span class="math inline">\(1,5\sigma\)</span> (<span class="math inline">\(k=1,5\)</span>) na média do processo.. Observa-se que na segunda amostra a carta identificou o desvio, plotando a média fora de controle.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EQI_4_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="implementação-4" class="level3">
<h3 class="anchored" data-anchor-id="implementação-4">Implementação</h3>
<p>Seja um processo de controle onde se adotam limites de 3 desvios-padrões, isto é <span class="math inline">\(L=3\)</span>, usa-se <span class="math inline">\(n=5\)</span> e há um deslocamento de <span class="math inline">\(1,5\sigma\)</span>, isto é, <span class="math inline">\(k = 1,5\)</span>. Qual o risco de a próxima amostra não detectar o desvio?</p>
<p>Deve-se resolver:</p>
<p><span class="math display">\[
\beta = \Phi(3-1,5\sqrt{5}) - \Phi(-3-1,5\sqrt{5})
\]</span></p>
<p>Resolvendo via R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="dv">3</span><span class="fl">-1.5</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span>))<span class="sc">-</span><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">3</span><span class="fl">-1.5</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">5</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>beta</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3616312</code></pre>
</div>
</div>
<p>Logo, a carta com <span class="math inline">\(L=3\)</span> e <span class="math inline">\(n=5\)</span> tem 0,36 de probabilidade de não detectar um desvio na primeira amostra após o problema. O comprimento médio da sequência para detectar o desvio, <span class="math inline">\(ARL_1\)</span> pode ser obtido conforme segue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>beta)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.566493</code></pre>
</div>
</div>
<p>Ou seja, entre uma ou duas amostras serão necessárias para detectar tal deslocamento.</p>
<p>Seja um processo de controle onde se adotam limites de 3 desvios-padrões, isto é <span class="math inline">\(L=3\)</span>, usa-se <span class="math inline">\(n=3\)</span> e há um deslocamento de <span class="math inline">\(1\sigma\)</span>, isto é, <span class="math inline">\(k = 1\)</span>. Qual a probabilidade de a próxima amostra não detectar o desvio?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>L<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(L<span class="sc">-</span>k<span class="sc">*</span><span class="fu">sqrt</span>(n)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>L<span class="sc">-</span>k<span class="sc">*</span><span class="fu">sqrt</span>(n))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>beta</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8975908</code></pre>
</div>
</div>
<p>Qual o número médio de amostras para detectar tal desvio?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ARL1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>beta)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ARL1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.764752</code></pre>
</div>
</div>
<section id="definição-do-desvio-padrão-amostral" class="level4">
<h4 class="anchored" data-anchor-id="definição-do-desvio-padrão-amostral">1. Definição do Desvio Padrão Amostral</h4>
<p>O desvio padrão amostral é definido como:</p>
<p><span class="math display">\[s = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{x})^2}\]</span></p>
<p>onde <span class="math inline">\(\overline{x}\)</span> é a média amostral.</p>
</section>
<section id="distribuição-de-s" class="level4">
<h4 class="anchored" data-anchor-id="distribuição-de-s">2. Distribuição de <span class="math inline">\(s\)</span></h4>
<p>Assumindo que <span class="math inline">\(X_i \sim N(\mu, \sigma^2)\)</span> i.i.d., sabemos que:</p>
<p><span class="math display">\[\frac{(n-1)s^2}{\sigma^2} \sim \chi^2_{n-1}\]</span></p>
</section>
<section id="cálculo-de-es" class="level4">
<h4 class="anchored" data-anchor-id="cálculo-de-es">3. Cálculo de <span class="math inline">\(E(s)\)</span></h4>
<p>Podemos expressar <span class="math inline">\(s\)</span> em termos da distribuição qui-quadrado:</p>
<p><span class="math display">\[s = \sigma \sqrt{\frac{\chi^2_{n-1}}{n-1}}\]</span></p>
<p>Portanto:</p>
<p><span class="math display">\[E(s) = \sigma E\left(\sqrt{\frac{\chi^2_{n-1}}{n-1}}\right) = \frac{\sigma}{\sqrt{n-1}} E\left(\sqrt{\chi^2_{n-1}}\right)\]</span></p>
</section>
<section id="esperança-da-raiz-quadrada-de-chi2" class="level4">
<h4 class="anchored" data-anchor-id="esperança-da-raiz-quadrada-de-chi2">4. Esperança da Raiz Quadrada de <span class="math inline">\(\chi^2\)</span></h4>
<p>Para uma variável qui-quadrado com <span class="math inline">\(\nu\)</span> graus de liberdade:</p>
<p><span class="math display">\[E\left(\sqrt{\chi^2_{\nu}}\right) = \sqrt{2} \frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\Gamma\left(\frac{\nu}{2}\right)}\]</span></p>
<p>Aplicando para <span class="math inline">\(\nu = n-1\)</span>:</p>
<p><span class="math display">\[E\left(\sqrt{\chi^2_{n-1}}\right) = \sqrt{2} \frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)}\]</span></p>
</section>
<section id="resultado-final" class="level4">
<h4 class="anchored" data-anchor-id="resultado-final">5. Resultado Final</h4>
<p>Substituindo:</p>
<p><span class="math display">\[E(s) = \frac{\sigma}{\sqrt{n-1}} \cdot \sqrt{2} \frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)} = \sigma \cdot \sqrt{\frac{2}{n-1}} \frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)}\]</span></p>
<p>Portanto:</p>
<p><span class="math display">\[c_4 = \sqrt{\frac{2}{n-1}} \frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)}\]</span></p>
</section>
</section>
<section id="verificação-numérica-em-r" class="level3">
<h3 class="anchored" data-anchor-id="verificação-numérica-em-r">Verificação Numérica em R</h3>
<p>Podemos verificar o valor de <span class="math inline">\(c_4\)</span> para diferentes tamanhos amostrais:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular c4</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>c4 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> <span class="fu">gamma</span>(n<span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>((n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo para n = 5</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>c4_value <span class="ot">&lt;-</span> <span class="fu">c4</span>(n)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>c4_value</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9399856</code></pre>
</div>
</div>
</section>
<section id="prova-que-o-desvio-padrão-de-s-é-sigmasqrt1---c_42" class="level3">
<h3 class="anchored" data-anchor-id="prova-que-o-desvio-padrão-de-s-é-sigmasqrt1---c_42">Prova que o desvio padrão de <span class="math inline">\(s\)</span> é <span class="math inline">\(\sigma\sqrt{1 - c_4^2}\)</span></h3>
<p>Queremos demonstrar que:</p>
<p><span class="math display">\[\sigma_s = \sigma \sqrt{1 - c_4^2}\]</span></p>
<p>onde: - <span class="math inline">\(s\)</span> é o desvio padrão amostral - <span class="math inline">\(\sigma\)</span> é o desvio padrão populacional - <span class="math inline">\(c_4\)</span> é o fator de correção para amostras finitas</p>
<section id="relação-entre-variância-de-s-e-s2" class="level4">
<h4 class="anchored" data-anchor-id="relação-entre-variância-de-s-e-s2">1. Relação entre Variância de <span class="math inline">\(s\)</span> e <span class="math inline">\(s^2\)</span></h4>
<p>Sabemos que: <span class="math display">\[\text{Var}(s) = E(s^2) - [E(s)]^2\]</span></p>
<p>Mas <span class="math inline">\(E(s^2) = \sigma^2\)</span> (estimador não viesado da variância)</p>
<p>E já demonstramos anteriormente que <span class="math inline">\(E(s) = c_4 \sigma\)</span></p>
<p>Portanto: <span class="math display">\[\text{Var}(s) = \sigma^2 - (c_4 \sigma)^2 = \sigma^2 (1 - c_4^2)\]</span></p>
</section>
<section id="desvio-padrão-de-s" class="level4">
<h4 class="anchored" data-anchor-id="desvio-padrão-de-s">2. Desvio Padrão de <span class="math inline">\(s\)</span></h4>
<p>Tomando a raiz quadrada da variância: <span class="math display">\[\sigma_s = \sqrt{\text{Var}(s)} = \sqrt{\sigma^2 (1 - c_4^2)} = \sigma \sqrt{1 - c_4^2}\]</span></p>
</section>
<section id="verificação-da-fórmula-de-c_4" class="level4">
<h4 class="anchored" data-anchor-id="verificação-da-fórmula-de-c_4">3. Verificação da Fórmula de <span class="math inline">\(c_4\)</span></h4>
<p>Recordemos a definição de <span class="math inline">\(c_4\)</span>: <span class="math display">\[c_4 = \sqrt{\frac{2}{n-1}} \frac{\Gamma\left(\frac{n}{2}\right)}{\Gamma\left(\frac{n-1}{2}\right)}\]</span></p>
</section>
<section id="verificação-numérica-em-r-1" class="level4">
<h4 class="anchored" data-anchor-id="verificação-numérica-em-r-1">4. Verificação Numérica em R</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para calcular c4</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>c4 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> <span class="fu">gamma</span>(n<span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>((n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulação para verificar a fórmula</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulação de amostras normais</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>s_values <span class="ot">&lt;-</span> <span class="fu">replicate</span>(nsim, {</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>(x)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Desvio padrão observado de s</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>observed_sd_s <span class="ot">&lt;-</span> <span class="fu">sd</span>(s_values)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor teórico</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>c4_val <span class="ot">&lt;-</span> <span class="fu">c4</span>(n)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>theoretical_sd_s <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> c4_val<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparação</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observado =</span> observed_sd_s,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  Teórico <span class="ot">=</span> theoretical_sd_s,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Erro =</span> <span class="fu">abs</span>(observed_sd_s <span class="sc">-</span> theoretical_sd_s)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Observado   Teórico         Erro
1 0.4653479 0.4644736 0.0008743116</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>